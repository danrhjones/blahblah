--- 
- 
  name: "Install rng tools"
  package: 
    name: rng-tools
    state: present
  when: 
    - "ansible_os_family == 'RedHat'"
    - "ansible_distribution_major_version == \"7\""
- 
  lineinfile: "dest=/usr/lib/systemd/rngd.service regexp=^ExecStart= line='ExecStart=/sbin/rngd -f-r /dev/urandom'"
  name: "Ensure rngd config"
  notify: 
    - "Restart rngd"
  when: 
    - "ansible_os_family == 'RedHat'"
    - "ansible_distribution_major_version == \"7\""
- 
  name: "Start rngd"
  service: 
    enabled: true
    name: rngd
    state: started
  when: 
    - "ansible_os_family == 'RedHat'"
    - "ansible_distribution_major_version == \"7\""
